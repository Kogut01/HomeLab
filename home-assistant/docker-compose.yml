services:
  home-assistant:
    image: ghcr.io/home-assistant/home-assistant:stable
    container_name: home-assistant
    restart: unless-stopped

    privileged: true

    volumes:
      - type: bind
        source: ./config
        target: /config
        read_only: false
        bind:
          create_host_path: true

      - type: bind
        source: /etc/localtime
        target: /etc/localtime
        read_only: true
        bind:
          create_host_path: false

      - type: bind
        source: /run/dbus
        target: /run/dbus
        read_only: true
        bind:
          create_host_path: false

    environment:
      - TZ=${TZ}

    network_mode: host

    healthcheck:
      test: ["CMD", "curl", "-f", "-s", "http://localhost:8123"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s